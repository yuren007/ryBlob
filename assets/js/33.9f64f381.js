(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{527:function(s,e,t){"use strict";t.r(e);var n=t(28),a=Object(n.a)({},(function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h4",{attrs:{id:"cors和jsonp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cors和jsonp"}},[s._v("#")]),s._v(" CORS和JSONP")]),s._v(" "),t("p",[s._v("对于简单请求，浏览器直接发出CORS请求。具体来说，就是在头信息之中，增加一个Origin字段。")]),s._v(" "),t("p",[s._v("Origin字段用来说明，本次请求来自哪个源（协议 + 域名 + 端口）。服务器根据这个值，决定是否同意这次请求。")]),s._v(" "),t("p",[s._v("服务端返回：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("Access-Control-Allow-Origin: http://api.bob.com\nAccess-Control-Allow-Credentials: true\nAccess-Control-Expose-Headers: FooBar\nContent-Type: text/html; charset=utf-8\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[t("strong",[s._v("1. Access-Control-Allow-Origin:")])]),s._v(" "),t("p",[s._v("该字段是必须的。它的值要么是请求时Origin字段的值，要么是一个*，表示接受任意域名的请求。")]),s._v(" "),t("p",[t("strong",[s._v("2. Access-Control-Allow-Credentials")])]),s._v(" "),t("p",[s._v("该字段可选。它的值是一个布尔值，表示是否允许发送Cookie。")]),s._v(" "),t("p",[t("strong",[s._v("3. Access-Control-Expose-Headers")])]),s._v(" "),t("p",[s._v("该字段可选。CORS请求时，XMLHttpRequest对象的getResponseHeader()方法只能拿到6个基本字段：Cache-Control、Content-Language、Content-Type、Expires、Last-Modified、Pragma。如果想拿到其他字段，就必须在Access-Control-Expose-Headers里面指定。上面的例子指定，getResponseHeader('FooBar')可以返回FooBar字段的值。")]),s._v(" "),t("p",[s._v("客户端请求是加上withCredentials 属性，可以不主动发cookie信息。")]),s._v(" "),t("p",[t("strong",[s._v("请求方法是PUT或DELETE，或者Content-Type字段的类型是application/json时：")])]),s._v(" "),t("p",[s._v("预检请求http头")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("OPTIONS /cors HTTP/1.1\nOrigin: http://api.bob.com\nAccess-Control-Request-Method: PUT\nAccess-Control-Request-Headers: X-Custom-Header\nHost: api.alice.com\nAccept-Language: en-US\nConnection: keep-alive\nUser-Agent: Mozilla/5.0...\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[t("strong",[s._v("（1）Access-Control-Request-Method")])]),s._v(" "),t("p",[s._v("该字段是必须的，用来列出浏览器的CORS请求会用到哪些HTTP方法，上例是PUT。")]),s._v(" "),t("p",[t("strong",[s._v("（2）Access-Control-Request-Headers")])]),s._v(" "),t("p",[s._v("该字段是一个逗号分隔的字符串，指定浏览器CORS请求会额外发送的头信息字段，上例是X-Custom-Header。")]),s._v(" "),t("p",[s._v("服务器回应的其他CORS相关字段如下。")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("Access-Control-Allow-Methods: GET, POST, PUT\nAccess-Control-Allow-Headers: X-Custom-Header\nAccess-Control-Allow-Credentials: true\nAccess-Control-Max-Age: 1728000\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[t("strong",[s._v("（1）Access-Control-Allow-Methods")])]),s._v(" "),t("p",[s._v('该字段必需，它的值是逗号分隔的一个字符串，表明服务器支持的所有跨域请求的方法。注意，返回的是所有支持的方法，而不单是浏览器请求的那个方法。这是为了避免多次"预检"请求。')]),s._v(" "),t("p",[t("strong",[s._v("（2）Access-Control-Allow-Headers")])]),s._v(" "),t("p",[s._v('如果浏览器请求包括Access-Control-Request-Headers字段，则Access-Control-Allow-Headers字段是必需的。它也是一个逗号分隔的字符串，表明服务器支持的所有头信息字段，不限于浏览器在"预检"中请求的字段。')]),s._v(" "),t("p",[t("strong",[s._v("（3）Access-Control-Allow-Credentials")])]),s._v(" "),t("p",[s._v("该字段与简单请求时的含义相同。")]),s._v(" "),t("p",[t("strong",[s._v("（4）Access-Control-Max-Age")])]),s._v(" "),t("p",[s._v("该字段可选，用来指定本次预检请求的有效期，单位为秒。上面结果中，有效期是20天（1728000秒），即允许缓存该条回应1728000秒（即20天），在此期间，不用发出另一条预检请求。")]),s._v(" "),t("p",[s._v('一旦服务器通过了"预检"请求，以后每次浏览器正常的CORS请求，就都跟简单请求一样，会有一个Origin头信息字段。服务器的回应，也都会有一个Access-Control-Allow-Origin头信息字段。')]),s._v(" "),t("h5",{attrs:{id:"与jsonp的比较"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#与jsonp的比较"}},[s._v("#")]),s._v(" 与JSONP的比较")]),s._v(" "),t("p",[s._v("CORS与JSONP的使用目的相同，但是比JSONP更强大。")]),s._v(" "),t("p",[s._v("JSONP只支持GET请求，CORS支持所有类型的HTTP请求。JSONP的优势在于支持老式浏览器，以及可以向不支持CORS的网站请求数据。")]),s._v(" "),t("h4",{attrs:{id:"nginx反向代理解决跨域"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nginx反向代理解决跨域"}},[s._v("#")]),s._v(" nginx反向代理解决跨域")]),s._v(" "),t("h3",{attrs:{id:"iframe等"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#iframe等"}},[s._v("#")]),s._v(" iframe等")])])}),[],!1,null,null,null);e.default=a.exports}}]);