(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{526:function(v,_,l){"use strict";l.r(_);var i=l(28),o=Object(i.a)({},(function(){var v=this,_=v.$createElement,l=v._self._c||_;return l("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[l("p",[l("strong",[v._v("导航")])]),v._v(" "),l("p",[l("strong",[v._v("用户输入")])]),v._v(" "),l("ol",[l("li",[v._v("用户在地址栏按下回车，检查输入（关键字 or 符合 URL 规则），组装完整 URL；")]),v._v(" "),l("li",[v._v("回车前，当前页面执行 onbeforeunload 事件；")]),v._v(" "),l("li",[v._v("浏览器进入加载状态。")])]),v._v(" "),l("p",[l("strong",[v._v("URL 请求")])]),v._v(" "),l("ol",[l("li",[v._v("浏览器进程通过 IPC 把 URL 请求发送至网络进程；")]),v._v(" "),l("li",[v._v("查找资源缓存（有效期内）；")]),v._v(" "),l("li",[v._v("DNS 解析（查询 DNS 缓存）；")]),v._v(" "),l("li",[v._v("进入 TCP 队列（单个域名 TCP 连接数量限制）；")]),v._v(" "),l("li",[v._v("创建 TCP 连接（三次握手）；")]),v._v(" "),l("li",[v._v("HTTPS 建立 TLS 连接（client hello, server hello, pre-master key 生成『对话密钥』）；")]),v._v(" "),l("li",[v._v("发送 HTTP 请求（请求行[方法、URL、协议]、请求头 Cookie 等、请求体 POST）；")]),v._v(" "),l("li",[v._v("接受请求（响应行[协议、状态码、状态消息]、响应头、响应体等）；\n"),l("ul",[l("li",[v._v("状态码 301 / 302，根据响应头中的 Location 重定向；")]),v._v(" "),l("li",[v._v("状态码 200，根据响应头中的 Content-Type 决定如何响应（下载文件、加载资源、渲染 HTML）。")])])])]),v._v(" "),l("p",[l("strong",[v._v("准备渲染进程")])]),v._v(" "),l("ol",[l("li",[v._v("根据是否同一站点（相同的协议和根域名），决定是否复用渲染进程。")])]),v._v(" "),l("p",[l("strong",[v._v("提交文档")])]),v._v(" "),l("ol",[l("li",[v._v("浏览器进程接受到网路进程的响应头数据，向渲染进程发送『提交文档』消息；")]),v._v(" "),l("li",[v._v("渲染进程收到『提交文档』消息后，与网络进程建立传输数据『管道』；")]),v._v(" "),l("li",[v._v("传输完成后，渲染进程返回『确认提交』消息给浏览器进程；")]),v._v(" "),l("li",[v._v("浏览器接受『确认提交』消息后，移除旧文档、更新界面、地址栏，导航历史状态等；")]),v._v(" "),l("li",[v._v("此时标识浏览器加载状态的小圆圈，从此前 URL 网络请求时的逆时针选择，即将变成顺时针旋转（进入渲染阶段）。")])]),v._v(" "),l("p",[l("strong",[v._v("渲染")])]),v._v(" "),l("p",[l("strong",[v._v("渲染流水线")])]),v._v(" "),l("p",[l("strong",[v._v("构建 DOM 树")])]),v._v(" "),l("ol",[l("li",[v._v("输入：HTML 文档；")]),v._v(" "),l("li",[v._v("处理：HTML 解析器解析；")]),v._v(" "),l("li",[v._v("输出：DOM 数据解构。")])]),v._v(" "),l("p",[l("strong",[v._v("样式计算")])]),v._v(" "),l("ol",[l("li",[v._v("输入：CSS 文本；")]),v._v(" "),l("li",[v._v("处理：属性值标准化，每个节点具体样式（继承、层叠）；")]),v._v(" "),l("li",[v._v("输出：styleSheets(CSSOM)。")])]),v._v(" "),l("p",[l("strong",[v._v("布局(DOM 树中元素的计划位置)")])]),v._v(" "),l("ol",[l("li",[v._v("DOM & CSSOM 合并成渲染树；")]),v._v(" "),l("li",[v._v("布局树（DOM 树中的可见元素）；")]),v._v(" "),l("li",[v._v("布局计算。")])]),v._v(" "),l("p",[l("strong",[v._v("分层")])]),v._v(" "),l("ol",[l("li",[v._v("特定节点生成专用图层，生成一棵图层树（层叠上下文、Clip，类似 PhotoShop 里的图层）；")]),v._v(" "),l("li",[v._v("拥有层叠上下文属性（明确定位属性、透明属性、CSS 滤镜、z-index 等）的元素会创建单独图层；")]),v._v(" "),l("li",[v._v("没有图层的 DOM 节点属于父节点图层；")]),v._v(" "),l("li",[v._v("需要剪裁的地方也会创建图层。")])]),v._v(" "),l("p",[l("strong",[v._v("绘制指令")])]),v._v(" "),l("ol",[l("li",[v._v("输入：图层树；")]),v._v(" "),l("li",[v._v("渲染引擎对图层树中每个图层进行绘制；")]),v._v(" "),l("li",[v._v("拆分成绘制指令，生成绘制列表，提交到合成线程；")]),v._v(" "),l("li",[v._v("输出：绘制列表。")])]),v._v(" "),l("p",[l("strong",[v._v("分块")])]),v._v(" "),l("ol",[l("li",[v._v("合成线程会将较大、较长的图层（一屏显示不完，大部分不在视口内）划分为图块（tile, 256"),l("em",[v._v("256, 512")]),v._v("512）。")])]),v._v(" "),l("p",[l("strong",[v._v("光栅化（栅格化）")])]),v._v(" "),l("ol",[l("li",[v._v("在光栅化线程池中，将视口附近的图块优先生成位图（栅格化执行该操作）；")]),v._v(" "),l("li",[v._v("快速栅格化：GPU 加速，生成位图（GPU 进程）。")])]),v._v(" "),l("p",[l("strong",[v._v("合成绘制")])]),v._v(" "),l("ol",[l("li",[v._v("绘制图块命令——DrawQuad，提交给浏览器进程；")]),v._v(" "),l("li",[v._v("浏览器进程的 viz 组件，根据DrawQuad命令，绘制在屏幕上。")])]),v._v(" "),l("p",[l("strong",[v._v("相关概念")])]),v._v(" "),l("p",[l("strong",[v._v("重排")])]),v._v(" "),l("ol",[l("li",[v._v("更新了元素的几何属性（如宽、高、边距）；")]),v._v(" "),l("li",[v._v("触发重新布局，解析之后的一系列子阶段；")]),v._v(" "),l("li",[v._v("更新完成的渲染流水线，开销最大。")])]),v._v(" "),l("p",[l("strong",[v._v("重绘")])]),v._v(" "),l("ol",[l("li",[v._v("更新元素的绘制属性（元素的颜色、背景色、边框等）；")]),v._v(" "),l("li",[v._v("布局阶段不会执行（无几何位置变换），直接进入绘制阶段。")])]),v._v(" "),l("p",[l("strong",[v._v("合成")])]),v._v(" "),l("ol",[l("li",[v._v("直接进入合成阶段（例如CSS 的 transform 动画）；")]),v._v(" "),l("li",[v._v("直接执行合成阶段，开销最小。")])])])}),[],!1,null,null,null);_.default=o.exports}}]);